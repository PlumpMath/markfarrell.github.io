<!DOCTYPE html>
<html>
  <head>
    <title>Center for Research and Education on Aging</title>
    <link href="//maxcdn.bootstrapcdn.com/font-awesome/4.1.0/css/font-awesome.min.css" rel="stylesheet">
    <style>

      .main-header {
        font-family: serif;
        color: #FFD67D;
        top: 0;
        left: 0;
        right: 0;
        position: absolute;
        width: 100%;
        height: 31px;
        z-index: 100;
        padding-top: 5px;
        padding-bottom: 5px;
        background: #1A2C85;
      }

      .main-header ul {
        list-style-type: none;
        margin: 0;
        padding: 0;
      }

      .main-header li {
        float: left;
        padding-right: 10px;
        padding-left: 10px;
      }

      .main-header li a {
        color: inherit !important;
        text-decoration: none !important;
      }

      .main-footer {
        font-family: serif;
        color: #FFD67D;
        background: #1A2C85;
        bottom: 0;
        left: 0;
        right: 0;
        width: 100%;
        position: absolute;
        z-index: 100;
        padding-top: 5px;
        padding-bottom: 5px;
        height: 31px;
      }

      #graph-container {
        top: 0;
        bottom: 0;
        left: 0;
        right: 0;
        position: absolute;
        background: #121629;
        z-index: 0;
      }

    </style>
  </head>
  <body>

    <script src="js/sigma.min.js"></script>
    <script src="js/plugins/sigma.parsers.gexf.min.js"></script>
    <script src="js/plugins/sigma.plugins.dragNodes.min.js"></script>
    <script src="js/plugins/sigma.plugins.neighborhoods.min.js"></script>

    <div class="main-header">
      <ul>
        <li>
          <a href="http://crea.berkeley.edu" target="_blank">
            <img src="images/logo.png" alt="crea"/>
          </a>
        </li>
        <li style="float:right; line-height: 31px">
          <a class="fa fa-github fa-lg" href="http://github.com/markfarrell" target="_blank"></a>
        </li>
    </ul>
    </div>

    <div id="container">
      <div id="graph-container"></div>
    </div>

    <script>

      sigma.renderers.def = sigma.renderers.canvas

      var gexfPath = 'data/elastin-abstracts.gexf';

      var sig = new sigma({
        graph: new sigma.classes.graph(),
        container: 'graph-container',
        settings: {
          font: 'serif',
          drawEdgeLabels: true,
          edgeLabelSize: 'fixed',
          defaultEdgeLabelSize: 12,
          defaultEdgeLabelColor: '#997F46',
          edgeLabelThreshold: 1.0,
          labelSize: 'proportional',
          labelThreshold: 2.5,
          labelSizeRatio: 3.0,
          defaultLabelSize: 32,
          defaultLabelColor: '#FFD67D',
          minNodeSize: 0.5,
          maxNodeSize: 5.0,
          minEdgeSize: 0.1,
          maxEdgeSize: 0.4,
          scalingMode: 'outside',
          hideEdgesOnMove: true,
          doubleClickEnabled: false
        }});

        sigma.parsers.gexf(gexfPath, {}, function(gexfSig) {

          var graph = {
            nodes: gexfSig.graph.nodes(),
            edges: gexfSig.graph.edges()
          };

          sig.graph.clear();
          sig.graph.read(graph);
          sig.refresh();

          sigma.plugins.dragNodes(sig, sig.renderers[0]);

          sig.bind('doubleClickNode', function(e) {

            var neighborhood = gexfSig.graph.neighborhood(e.data.node.id);

            if(neighborhood.edges.length > 1) {

              sig.graph.clear();
              sig.graph.read(neighborhood);
              sig.camera.goTo({ x: 0, y: 0, angle: 0, ratio : 1 });
              sig.refresh();

            }

          });

          sig.bind('doubleClickStage', function(e) {

            sig.graph.clear();
            sig.graph.read(graph);
            sig.refresh();

          });

        });

    </script>
  </body>
</html>
